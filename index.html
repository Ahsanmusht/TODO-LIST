<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo List</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.6.1/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.css">
  <link href="https://fonts.googleapis.com/css2?family=Dosis:wght@300;400;500;600;700&display=swap" rel="stylesheet">
 
  <style>
     body {
      font-family: 'Dosis', sans-serif;
    }
    .todo-card {
      width: 300px;
      margin-bottom: 15px;
    }
    .todo-card img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }
    .navbar {
      padding-top: 15px;
      padding-bottom: 15px;
      margin-bottom: 30px;
    }
    .navbar .container {
      display: flex;
      align-items: center;
    }
    .navbar-brand {
      font-size: 24px;
      font-weight: bold;
      flex-grow: 1;
    }
    .search-input {
      width: 300px;
      margin-left: auto;
    }
    .todo-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .todo-form .form-label {
      font-weight: bold;
    }
    .add-todo-button {
      align-self: flex-end;
    }
    .todo-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .todo-list .card {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .todo-list .card .card-body {
      display: flex;
      gap: 10px;
    }
    .edit-buttons i {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <h1 class="navbar-brand">Todo List</h1>
      <input type="text" id="search-input" class="form-control search-input" placeholder="Search...">
    </div>
  </nav>

  <div class="container mt-5">
    <form id="todo-form" class="todo-form">
      <div class="mb-3">
        <label for="todo-text" class="form-label">Todo Text</label>
        <input type="text" id="todo-text" class="form-control" required>
      </div>
      <div class="mb-3">
        <label for="todo-image" class="form-label">Todo Image</label>
        <input type="file" id="todo-image" class="form-control">
      </div>
      <button type="submit" class="btn btn-primary add-todo-button">Add Todo</button>
    </form>

    <div id="todo-list" class="mt-4 todo-list"></div>
  </div>

  <script>
    const todoForm = document.getElementById('todo-form');
    const todoText = document.getElementById('todo-text');
    const todoImage = document.getElementById('todo-image');
    const todoList = document.getElementById('todo-list');
    const searchInput = document.getElementById('search-input');

    let todos = [];

    // Load todos from local storage
    function loadTodos() {
      const storedTodos = localStorage.getItem('todos');
      todos = storedTodos ? JSON.parse(storedTodos) : [];
    }

    // Save todos to local storage
    function saveTodos() {
      localStorage.setItem('todos', JSON.stringify(todos));
    }

    // Render todos
    function renderTodos() {
      const filteredTodos = todos.filter(todo => todo.text.toLowerCase().includes(searchInput.value.toLowerCase()));

      todoList.innerHTML = '';

      filteredTodos.forEach(todo => {
        const todoCard = document.createElement('div');
        todoCard.classList.add('card', 'todo-card');

        const todoImageContainer = document.createElement('div');
        todoImageContainer.classList.add('position-relative');

        const todoImage = document.createElement('img');
        todoImage.src = todo.image;
        todoImage.alt = 'Todo Image';
        todoImage.classList.add('card-img-top');

        const editImageButton = document.createElement('i');
        editImageButton.classList.add('btn', 'btn-primary','position-absolute', 'top-0', 'end-0', 'm-2' );
        editImageButton.innerHTML = '<i class="fa fa-pencil"></i>';
        editImageButton.addEventListener('click', () => {
          editTodoImage(todo);
        });

        todoImageContainer.appendChild(todoImage);
        todoImageContainer.appendChild(editImageButton);

        const todoCardBody = document.createElement('div');
        todoCardBody.classList.add('card-body');

        const todoText = document.createElement('h5');
        todoText.textContent = todo.text;

        const editButton = document.createElement('i');
        editButton.classList.add('btn', 'btn-primary', 'me-2');
        editButton.innerHTML = '<i class="fa fa-pencil"></i>';
        editButton.addEventListener('click', () => {
          editTodoText(todo);
        });

        const deleteButton = document.createElement('i');
        deleteButton.classList.add('btn', 'btn-danger');
        deleteButton.innerHTML = '<i class="fa fa-trash"></i>';
        deleteButton.addEventListener('click', () => {
          deleteTodoById(todo.id);
        });

        todoCardBody.appendChild(todoText);
        todoCardBody.appendChild(editButton);
        todoCardBody.appendChild(deleteButton);

        todoCard.appendChild(todoImageContainer);
        todoCard.appendChild(todoCardBody);

        todoList.appendChild(todoCard);
      });
    }

    // Add a new todo to the list
    function addTodo() {
      const text = todoText.value;
      const image = todoImage.files[0] ? URL.createObjectURL(todoImage.files[0]) : '';
      const id = Date.now().toString();
      const todo = { id, text, image };

      todos.push(todo);
      saveTodos();
      clearInputFields();
      renderTodos();
    }

    // Edit the todo text
    function editTodoText(todo) {
      const newText = prompt('Enter the updated text:', todo.text);

      if (newText) {
        todo.text = newText;
        saveTodos();
        renderTodos();
      }
    }

    // Edit the todo image
    function editTodoImage(todo) {
      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = 'image/*';

      fileInput.addEventListener('change', () => {
        if (fileInput.files && fileInput.files[0]) {
          const reader = new FileReader();

          reader.onload = function (e) {
            todo.image = e.target.result;
            saveTodos();
            renderTodos();
          };

          reader.readAsDataURL(fileInput.files[0]);
        }
      });

      fileInput.click();
    }

    // Delete a todo by ID
    function deleteTodoById(id) {
      todos = todos.filter(todo => todo.id !== id);
      saveTodos();
      renderTodos();
    }

    // Clear input fields
    function clearInputFields() {
      todoText.value = '';
      todoImage.value = '';
    }

    // Initialize the todo list
    function init() {
      loadTodos();
      renderTodos();

      todoForm.addEventListener('submit', (e) => {
        e.preventDefault();
        addTodo();
      });

      searchInput.addEventListener('input', () => {
        renderTodos();
      });
    }

    // Run initialization
    init();
  </script>
</body>
</html>
